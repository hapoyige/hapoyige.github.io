<!DOCTYPE html>
<html lang="en">
<head>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="keyword"  content="">
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>
        
        
        
    </title>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/aircloud.css">
    <link rel="stylesheet" href="/css/gitment.css">
    <!--<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">-->
    <link href="//at.alicdn.com/t/font_620856_pl6z7sid89qkt9.css" rel="stylesheet" type="text/css">
    <!-- ga & ba script hoook -->
    <script></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>

<body>

<!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="site-nav-toggle" id="site-nav-toggle">
    <button>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
    </button>
</div>

<div class="index-about">
    <i> 眼前彼岸，何止无边。 </i>
</div>

<div class="index-container">
    
    <div class="index-left">
        
<div class="nav" id="nav">
    <div class="avatar-name">
        <div class="avatar">
            <img src="/img/avatar.jpg" />
        </div>
        <div class="name">
            <i>TXD</i>
        </div>
    </div>
    <div class="contents" id="nav-content">
        <ul>
            <li >
                <a href="/">
                    <i class="iconfont icon-shouye1"></i>
                    <span>主页</span>
                </a>
            </li>
            <li >
                <a href="/tags">
                    <i class="iconfont icon-biaoqian1"></i>
                    <span>标签</span>
                </a>
            </li>
            <li >
                <a href="/archives">
                    <i class="iconfont icon-guidang2"></i>
                    <span>存档</span>
                </a>
            </li>
            <li >
                <a href="/about/">
                    <i class="iconfont icon-guanyu2"></i>
                    <span>关于</span>
                </a>
            </li>
            
            <li>
                <a id="search">
                    <i class="iconfont icon-sousuo1"></i>
                    <span>搜索</span>
                </a>
            </li>
            
        </ul>
    </div>
    
        <div id="toc" class="toc-article">
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#数据挖掘期末-Tweet-popularity-prediction"><span class="toc-text">数据挖掘期末 Tweet popularity prediction</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#成员及分工"><span class="toc-text">成员及分工</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#目的"><span class="toc-text">目的</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#模型和过程"><span class="toc-text">模型和过程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#数据预处理"><span class="toc-text">数据预处理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#传统机器学习方法"><span class="toc-text">传统机器学习方法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#不考虑文本信息"><span class="toc-text">不考虑文本信息</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#sklearn中的一些回归方法"><span class="toc-text">sklearn中的一些回归方法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#LR中当作多个回归任务"><span class="toc-text">LR中当作多个回归任务</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#LFM"><span class="toc-text">LFM</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#基于用户的协同过滤"><span class="toc-text">基于用户的协同过滤</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#考虑文本信息"><span class="toc-text">考虑文本信息</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#HFT模型"><span class="toc-text">HFT模型</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#简要介绍"><span class="toc-text">简要介绍</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#深度学习方法"><span class="toc-text">深度学习方法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#主要的网络结构"><span class="toc-text">主要的网络结构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#数据集"><span class="toc-text">数据集</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#关键步骤"><span class="toc-text">关键步骤</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#应用到当前问题"><span class="toc-text">应用到当前问题</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#效果"><span class="toc-text">效果</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#总结"><span class="toc-text">总结</span></a></li></ol></li></ol>
</div>
    
</div>


<div class="search-field" id="search-field">
    <div class="search-container">
        <div class="search-input">
            <span id="esc-search"> <i class="icon-fanhui iconfont"></i></span>
            <input id="search-input"/>
            <span id="begin-search">搜索</span>
        </div>
        <div class="search-result-container" id="search-result-container">

        </div>
    </div>
</div>
        <div class="index-about-mobile">
            <i> 眼前彼岸，何止无边。 </i>
        </div>
    </div>
    
    <div class="index-middle">
        <!-- Main Content -->
        


<div class="post-container">
    <div class="post-title">
        
    </div>

    <div class="post-meta">
        <span class="attr">发布于：<span>2018-06-29 20:58:12</span></span>
        
        </span>
        <span class="attr">访问：<span id="busuanzi_value_page_pv"></span>
</span>
</span>
    </div>
    <div class="post-content ">
        <h1 id="数据挖掘期末-Tweet-popularity-prediction"><a href="#数据挖掘期末-Tweet-popularity-prediction" class="headerlink" title="数据挖掘期末 Tweet popularity prediction"></a>数据挖掘期末 Tweet popularity prediction</h1><h2 id="成员及分工"><a href="#成员及分工" class="headerlink" title="成员及分工"></a>成员及分工</h2><p>陈宏俊(10152510101)  特征工程、部分传统机器学习模型</p>
<p>徐嘉欣(10152510228)  数据预处理、特征工程、LFM模型</p>
<p>汤旭东(10152510104)  数据预处理、MOOD调试、HFT模型</p>
<p>联系方式： <a href="mailto:851988701@qq.com" target="_blank" rel="noopener">851988701@qq.com</a></p>
<h2 id="目的"><a href="#目的" class="headerlink" title="目的"></a>目的</h2><p>根据一些历史数据，预测某用户发的某条tweet在将来的流行度，其中流行度 $popularity=log(retweet count)$ </p>
<h2 id="模型和过程"><a href="#模型和过程" class="headerlink" title="模型和过程"></a>模型和过程</h2><h3 id="数据预处理"><a href="#数据预处理" class="headerlink" title="数据预处理"></a>数据预处理</h3><p>hashtags,text都转为数字,去掉url和文本中的hashtags.</p>
<p><img src="D:\Major\大三下\期末pj_CCIR2018\tweet\汇报\data_prepro.png" alt="data_prepro"></p>
<h3 id="传统机器学习方法"><a href="#传统机器学习方法" class="headerlink" title="传统机器学习方法"></a>传统机器学习方法</h3><h4 id="不考虑文本信息"><a href="#不考虑文本信息" class="headerlink" title="不考虑文本信息"></a>不考虑文本信息</h4><p>考虑发布者的属性:status count,follwers count,推文的属性:hashtags, 含url的条数(url可能包含图片视频等更丰富的信息)，hashtags属性可用one hot编码（一共只有413个tags）,可进行PCA降维。</p>
<h5 id="sklearn中的一些回归方法"><a href="#sklearn中的一些回归方法" class="headerlink" title="sklearn中的一些回归方法"></a>sklearn中的一些回归方法</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">增添一个特征：作者的tweet平均关注度（followers_count/statuses_count）。这么做的原因是考虑到增加一个新的维度来衡量作者的影响力。以上的三个作者信息以及tweet的tags、和text共同构成了训练集和验证集的特征空间。</span><br><span class="line">   此处的tags因为是一个不定长的list，为了能够统一为定长的特征，将其所有出现过的tags进行统计，发现有413个，因此构建出一个413维的tags空间，每个tweet的tags出现一次就在对应位置加1，为了便于减少稀疏度和提高效率，将所有tweet的tags构成的矩阵进行pca降维，降至5维。</span><br></pre></td></tr></table></figure>
<p><img src="D:\Major\大三下\期末pj_CCIR2018\tweet\汇报\junjun.png" alt="junjun"></p>
<h5 id="LR中当作多个回归任务"><a href="#LR中当作多个回归任务" class="headerlink" title="LR中当作多个回归任务"></a>LR中当作多个回归任务</h5><p>为每个用户构建一个LR回归器，用各自的用户数据进行训练，发现MSE&gt;3，不优于单个回归器，猜测由于每个用户的训练数据不足导致。</p>
<h5 id="LFM"><a href="#LFM" class="headerlink" title="LFM"></a>LFM</h5><p><img src="D:\Major\大三下\期末pj_CCIR2018\tweet\汇报\xin_small.png" alt="xin_small"></p>
<p>MSE=2.2</p>
<h5 id="基于用户的协同过滤"><a href="#基于用户的协同过滤" class="headerlink" title="基于用户的协同过滤"></a>基于用户的协同过滤</h5><p>考虑用户和hashtags之间的相互影响，由于用户往往在同一tag下发过多条tweet,这里的score取平均值。</p>
<p>由于score受到用户followers影响比较明显，引入influence=score/log(followers).</p>
<p>采用皮尔逊相似度。但实现中发现取非常相似的用户做类别才能取得好一些的效果，所谓非常相似，实际上是基于对应用户的历史记录了（用户之前在相应tag下发过tweet）</p>
<p><img src="D:\Major\大三下\期末pj_CCIR2018\tweet\汇报\CF_res.png" alt="CF_res"></p>
<h4 id="考虑文本信息"><a href="#考虑文本信息" class="headerlink" title="考虑文本信息"></a>考虑文本信息</h4><p>#####　TFIDF编码+PCA降维</p>
<p>在LR模型上测试，总词数10000+，PCA降维至200</p>
<p>MSE=2.65，也并无提升。</p>
<h5 id="HFT模型"><a href="#HFT模型" class="headerlink" title="HFT模型"></a>HFT模型</h5><p>参考文章：<strong>Hidden Factors and Hidden Topics:Understanding Rating Dimensions with Review Text，Julian McAuley，Jure Leskovec</strong></p>
<p>这第二次作业的方法用在这儿略显生硬了，原因和协同过滤一样:tags多次出现。</p>
<h6 id="简要介绍"><a href="#简要介绍" class="headerlink" title="简要介绍"></a>简要介绍</h6><p>•LDA</p>
<p>•认为文档是这样形成的：1.随机选一个主题。2.在这个主题下随机选择属于这个主题的词汇。其中主题和主题的词汇都满足狄利克雷分布。目标是极大化似然</p>
<p>$$p(\tau|\theta,\phi,z)=\prod_{d\in\tau}\prod_{j=1}^{N_d}\theta_{d,z_{d,j}}\phi_{z_{d,j},w_{d,j}}$$</p>
<p>$w_{d,j}$表示文档d第j个词，$z_{d,j}$表示文档d第j个词属于哪个主题。$\theta_{d,k}$表示$\theta_d$属于主题k的概率，$\phi_{k,w}$表示词汇w属于主题k的概率。</p>
<p>•LFM中γi的维度和LDA中$\theta_d$的维度应该是一样的，它们都表示被用户们讨论的不同主题的个数！</p>
<p>•考虑到 $\theta_d$是一个分布，这样定义它们的正相关关系：</p>
<p>$$\theta_{i,k}=\frac{exp(\kappa\gamma_{i,k})}{\sum_{k’}exp(\kappa\gamma_{i,k’})}$$</p>
<p>•这样HFT要最小化的目标函数：</p>
<p>$$f(\tau|\theta,\phi,\kappa,z)=\sum_{r_{u,i}\in\tau}\underbrace{(rec(u,i)-r_{u,i})^2}<em>{rating \ error}-\mu\underbrace{l(\tau|\theta,\phi,z)}</em>{corpus \ likelihood}$$</p>
<p>•其中对LDA的似然取了对数</p>
<p>•关于如何训练模型，采用一种类似EM算法的策略：</p>
<p><img src="D:\Major\大三下\期末pj_CCIR2018\tweet\汇报\HFT_train.png" alt="HFT_train"></p>
<p>•其中(7)采用L-BFGS，一种拟牛顿方法。(8)根据(7)的结果进行topic assignment.</p>
<h3 id="深度学习方法"><a href="#深度学习方法" class="headerlink" title="深度学习方法"></a>深度学习方法</h3><p>参考文章: <strong>Factorization Meets Memory Network:Learning to Predict Activity Popularity, Wen Wang, Wei Zhang  and Jun Wang</strong></p>
<h4 id="主要的网络结构"><a href="#主要的网络结构" class="headerlink" title="主要的网络结构"></a>主要的网络结构</h4><p><img src="D:\Major\大三下\期末pj_CCIR2018\tweet\汇报\mood.png" alt="mood"></p>
<h4 id="数据集"><a href="#数据集" class="headerlink" title="数据集"></a>数据集</h4><p>{u,q,d,r}:user,location,document,rating</p>
<p>其中 rating=log(retweet_count)</p>
<h4 id="关键步骤"><a href="#关键步骤" class="headerlink" title="关键步骤"></a>关键步骤</h4><p>认为每个词，出现在不同的用户的tweet中，在网络中会有不同的权重。</p>
<p>$$\omega_{v(j)}^{u,q}=(u_u^A+q_q^A)\top e_{v(j)}$$</p>
<p>更大的权重表示词v(j)和用户、相应地点的关联性越大。</p>
<p>作为网络的输入，用softmax归一化:</p>
<p>$p_{v(j)}^{u,q}=softmax(w_{v(j)}^{u,q})$  ,  $o=\sum_jp_{v(j)}^{u,q}f_{v(j)}$</p>
<p>拓展到多层网络中:</p>
<p>$$u_u^{A,k+1}=u_u^{A,k}+o^k$$</p>
<p>$$q_u^{A,k+1}=q_u^{A,k}+o^k$$</p>
<p>$$o_d=o^K+u_u^{A,K}+q^{A,K}_q$$</p>
<p>向量表示和最终预测:</p>
<p>$$\psi_d^{u,q}=u_u^I\odot q_q^I+u_u^I\odot o_d+q_q^I\odot o_d$$</p>
<p>$$\hat{r}=\theta\top \delta(W_1^T[\psi_d^{u,q};u_u^B;q_q^B]+b_1)+b$$</p>
<h4 id="应用到当前问题"><a href="#应用到当前问题" class="headerlink" title="应用到当前问题"></a>应用到当前问题</h4><p>文章解决的问题，和手头数据集比，多了location信息，少了hashtags信息，但location是一维的，hashtags可能有多维。处理时对hashtags取平均或随机选一个，效果差不多。</p>
<h4 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h4><p>出乎意料地，该模型达到了很好的效果，最终的预测文件也由该模型生成。向深度学习低头。</p>
<p><img src="D:\Major\大三下\期末pj_CCIR2018\tweet\DL_result.png" alt="DL_result"></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>​    小组成员各抒己见，尝试了自己的模型，但鲜有能跑出好效果的模型（无法优于论文中的深度学习模型），也不奇怪，毕竟是当前比较热门的研究方向，有一定难度。</p>
<p>​    大家对数据预处理、特征工程的理解更深了，也更熟悉了sklearn的一些有用模块，收获颇丰。</p>

        
        <div id="comment-container">
        </div>
    </div>
</div>
    </div>
</div>


<footer class="footer">
    <ul class="list-inline text-center">
        
        

        

        

        

        

    </ul>
    
    <p>
        <span id="busuanzi_container_site_pv">
            <span id="busuanzi_value_site_pv"></span>PV
        </span>
        <span id="busuanzi_container_site_uv">
            <span id="busuanzi_value_site_uv"></span>UV
        </span>
        Created By <a href="https://hexo.io/">Hexo</a>  Theme <a href="https://github.com/aircloud/hexo-theme-aircloud">AirCloud</a></p>
</footer><!-- hexo-inject:begin --><!-- hexo-inject:end -->




</body>

<script>
    // We expose some of the variables needed by the front end
    window.hexo_search_path = "search.xml"
    window.hexo_root = "/"
    window.isPost = true
</script>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<script src="/js/index.js"></script>
<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<script src="/js/gitment.js"></script>
<script>
    var gitment = new Gitment({
        id: '',
        owner: 'hapoyige',
        repo: 'hapoyige.github.io',
        oauth: {
            client_id: 'c00a93a12fbdf874defc',
            client_secret: '3f773f09baa58891d4d6e2bc5065f04780c89a70',
        },
    })
    gitment.render('comment-container')
</script>

</html>
